<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Rationale &mdash; Ragger 1.14.5.dev2 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
      <link rel="stylesheet" type="text/css" href="_static/sphinxcontrib-images/LightBox2/lightbox2/dist/css/lightbox.css" />

  
    <link rel="shortcut icon" href="_static/ragger.png"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script src="_static/sphinxcontrib-images/LightBox2/lightbox2/dist/js/lightbox-plus-jquery.min.js"></script>
        <script src="_static/sphinxcontrib-images/LightBox2/lightbox2-customize/jquery-noconflict.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorials" href="tutorial.html" />
    <link rel="prev" title="Installation" href="installation.html" />
    <link href="_static/layout.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Ragger
          </a>
              <div class="version">
                1.14
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">How is this doc structured:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Rationale</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#abstracting-the-backends">Abstracting the backends</a></li>
<li class="toctree-l2"><a class="reference internal" href="#easing-the-development-of-application-clients">Easing the development of application clients</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#navigation">Navigation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stax-screen-management">Stax screen management</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="source.html">Code documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Ragger</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Rationale</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/rationale.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="rationale">
<span id="id1"></span><h1>Rationale<a class="headerlink" href="#rationale" title="Permalink to this heading"></a></h1>
<p>Testing, easily manipulating a Ledger <a class="reference internal" href="glossary.html#term-Application"><span class="xref std std-term">application</span></a> is hard. Although
<a class="reference internal" href="glossary.html#term-Speculos"><span class="xref std std-term">Speculos</span></a> strongly eases it, it cannot always replace IRL tests on
physical devices.</p>
<p>There are libraries allowing to communicate with a physical device. However,
it would be very convenient to be able to develop code which would be compatible
wherever the application runs, either on an emulator or on a physical device.</p>
<p>On top of this, all these libraries provides low-level functions like pressing a
button or sending APDUs. Applications can be complex pieces of software and
testing one require higher-level code.</p>
<div class="section" id="abstracting-the-backends">
<h2>Abstracting the backends<a class="headerlink" href="#abstracting-the-backends" title="Permalink to this heading"></a></h2>
<p>The original goal of <code class="docutils literal notranslate"><span class="pre">Ragger</span></code> is to make the manipulation of an
<a class="reference internal" href="glossary.html#term-Application"><span class="xref std std-term">application</span></a> oblivious of the underlying device. Most applications are
tested against <a class="reference internal" href="glossary.html#term-Speculos"><span class="xref std std-term">Speculos</span></a>, the Ledger device emulator, but it is not
always enough, and testing on real physical devices is often required.</p>
<p><code class="docutils literal notranslate"><span class="pre">Ragger</span></code> provides an interface which wraps several libraries:</p>
<ul class="simple">
<li><p>one emulator-only library: <a class="reference internal" href="glossary.html#term-Speculos"><span class="xref std std-term">Speculos</span></a> (which uses itself as an emulator),</p></li>
<li><p>two agnostic libraries, which can communicate with either a physical device,
or an emulated one:</p>
<ul>
<li><p><a class="reference internal" href="glossary.html#term-LedgerComm"><span class="xref std std-term">LedgerComm</span></a></p></li>
<li><p><a class="reference internal" href="glossary.html#term-LedgerWallet"><span class="xref std std-term">LedgerWallet</span></a></p></li>
</ul>
</li>
</ul>
<p>In <code class="docutils literal notranslate"><span class="pre">Ragger</span></code>, the classes embedding these libraries are called
<a class="reference internal" href="glossary.html#term-Backend"><span class="xref std std-term">backends</span></a>. Any other backend can be added, given it respects the
<code class="xref py py-class docutils literal notranslate"><span class="pre">BackendInterface</span></code> interface.</p>
<figure class="">
            <a 
               data-lightbox="group-29723739-6adc-4518-a5e8-9f03ad025433"
               href="_images/usage.svg"
               title="Software / communication layers between an application and its client"
               data-title="Software / communication layers between an application and its client"
               
               ><img src="_images/usage.svg"
                     class="align-center"
                     width="90%"
                     height="auto"
                     alt=""/>
                </a><figcaption>Software / communication layers between an application and its client</figcaption>
            </figure><p>Application <a class="reference internal" href="glossary.html#term-Client"><span class="xref std std-term">clients</span></a> using <code class="docutils literal notranslate"><span class="pre">Ragger</span></code> must comply with this
interface to communicate with the application. Once it’s done, the client
can communicate with an application running either on top of an emulator or on
a real, physical device with very little cost.</p>
<p>Why not <strong>no</strong> cost? That’s because the backend actually needs to talk to
something. Speculos is conveniently able to start its emulator itself, however
the other backends will need the application to be already started. Typically,
the application will have to be installed on a physical device, started, and the
device connected to the computer launching the client.</p>
<p>How to exploit these capabilities to write test running on both emulated or
physical device is documented in the <a class="reference internal" href="tutorial.html#tutorial"><span class="std std-ref">tutorial section</span></a>.</p>
</div>
<div class="section" id="easing-the-development-of-application-clients">
<h2>Easing the development of application clients<a class="headerlink" href="#easing-the-development-of-application-clients" title="Permalink to this heading"></a></h2>
<p>On top of abstracting the backend, <code class="docutils literal notranslate"><span class="pre">Ragger</span></code> provides tools and mechanisms
allowing to ease the development of application clients and write more thorough
tests.</p>
<div class="section" id="navigation">
<span id="rationale-navigation"></span><h3>Navigation<a class="headerlink" href="#navigation" title="Permalink to this heading"></a></h3>
<p>In particular, <code class="docutils literal notranslate"><span class="pre">Ragger</span></code> offers abstraction layers to declare application flows
without repeating oneself. This is the role of the
<code class="xref py py-class docutils literal notranslate"><span class="pre">Navigator</span></code> interface.</p>
<p>This class allows to declare a set of
<code class="xref py py-class docutils literal notranslate"><span class="pre">navigation</span> <span class="pre">instructions</span></code>) which, bound with
callbacks, allows to abstract the expected behavior of an application.</p>
<p>Once the instructions are declared, it is possible to declare feature flows as
a list of instructions.</p>
<figure class="">
            <a 
               data-lightbox="group-459fdd1d-2d0e-42b3-a280-da2c56a7bbea"
               href="_images/navigate.svg"
               title="Software / communication layers between an application and its client"
               data-title="Software / communication layers between an application and its client"
               
               ><img src="_images/navigate.svg"
                     class="align-center"
                     width="90%"
                     height="auto"
                     alt=""/>
                </a><figcaption>Software / communication layers between an application and its client</figcaption>
            </figure><p>The <code class="docutils literal notranslate"><span class="pre">Navigator</span></code> class also offers (with Speculos) screenshot checking
capabilities: while the instructions are performed, <code class="docutils literal notranslate"><span class="pre">Ragger</span></code> takes screenshots
of the application’s screen, and is able to save them or compare them with
<a class="reference internal" href="glossary.html#term-Golden-snapshot"><span class="xref std std-term">golden snapshots</span></a> to check if the application behaves
as expected.</p>
<p>This does not sound like much, but as soon as an application get a bit complex,
it helps a lot to write code which on the first hand manipulate high-level
concept as validating a transaction, and on the other hand deal with low-level
details such as crafting an <a class="reference internal" href="glossary.html#term-APDU"><span class="xref std std-term">APDU</span></a> and click on a button at the right time.</p>
</div>
<div class="section" id="stax-screen-management">
<h3>Stax screen management<a class="headerlink" href="#stax-screen-management" title="Permalink to this heading"></a></h3>
<p>Dealing with UI and user interaction is never simple. Nano devices has only two
user physical inputs, through the two buttons, which already allows some
elaborate combinations that could be challenging to test automatically.</p>
<p>With the Stax device and its touchable screen, the number of possibilities
drastically increases.</p>
<p><code class="docutils literal notranslate"><span class="pre">Ragger</span></code> embeds tools allowing to ease the development and the maintenance of
UI clients. this tools mainly consist of 3 components:</p>
<ul class="simple">
<li><p>the <code class="xref py py-class docutils literal notranslate"><span class="pre">layout</span> <span class="pre">classes</span></code>, representing
the layouts proposed in the NBGL section of the C SDK,</p></li>
<li><p>the <code class="xref py py-class docutils literal notranslate"><span class="pre">use</span> <span class="pre">cases</span> <span class="pre">classes</span></code>,
representing the use cases proposed in the NBGL section of the C SDK,</p></li>
<li><p>the <code class="xref py py-mod docutils literal notranslate"><span class="pre">screen</span> <span class="pre">module</span></code>, allowing to nest
the previous components in a single, centralized object.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are familiar with the <a class="reference internal" href="glossary.html#term-NBGL"><span class="xref std std-term">NBGL</span></a> library, you will notice that
<code class="docutils literal notranslate"><span class="pre">Ragger</span></code> does not implement a <a class="reference internal" href="glossary.html#term-Page"><span class="xref std std-term">Page</span></a> representation. It will be
integrated eventually.</p>
</div>
<p>These components bring multiple benefits:</p>
<ul class="simple">
<li><p>these abstractions prevent to directly use <code class="docutils literal notranslate"><span class="pre">(X,</span> <span class="pre">Y)</span></code> coordinates to interact
with the screen and propose higher-level methods (for instance, when using the
<code class="xref py py-class docutils literal notranslate"><span class="pre">UseCaseHome</span></code> use case,
going to the settings is triggered with the method <code class="docutils literal notranslate"><span class="pre">UseCaseHome.settings()</span></code>
instead of touching the screen at <code class="docutils literal notranslate"><span class="pre">(342,</span> <span class="pre">55)</span></code>). The client’s code is
meaningful.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ragger</span></code> internally keeps track of these positions on <strong>every</strong> <a class="reference internal" href="glossary.html#term-SDK"><span class="xref std std-term">SDK</span></a>
version. If a new SDK version moves a button to other coordinates, the
code written with the <code class="docutils literal notranslate"><span class="pre">Ragger</span></code> components will stay valid and functional.</p></li>
<li><p>the <a class="reference internal" href="glossary.html#term-Layout"><span class="xref std std-term">layouts</span></a> and <a class="reference internal" href="glossary.html#term-Use-Case"><span class="xref std std-term">use cases</span></a> mimic the
<a class="reference internal" href="glossary.html#term-NBGL"><span class="xref std std-term">NBGL</span></a> capabilities, so that the <code class="docutils literal notranslate"><span class="pre">Ragger</span></code> client screen architecture
is close to the application one.</p></li>
<li><p>the <code class="xref py py-class docutils literal notranslate"><span class="pre">FullScreen</span></code> class
embeds every existing <code class="xref py py-class docutils literal notranslate"><span class="pre">layout</span></code> and
<code class="xref py py-class docutils literal notranslate"><span class="pre">use</span> <span class="pre">case</span></code> in a single class,
providing a fast way of testing an interface without any other configuration.</p></li>
<li><p>the <code class="xref py py-class docutils literal notranslate"><span class="pre">MetaScreen</span></code> metaclass
allows to build custom screen classes nesting the
<code class="xref py py-class docutils literal notranslate"><span class="pre">layouts</span></code> and the
<code class="xref py py-class docutils literal notranslate"><span class="pre">use</span> <span class="pre">cases</span></code> of your choosing,
creating a convenient and meaningful screen object where all UI interactions
are centralized.</p></li>
</ul>
<p>You can find example of these components in <a class="reference internal" href="tutorial_screen.html#tutorial-screen"><span class="std std-ref">this tutorial</span></a>.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tutorial.html" class="btn btn-neutral float-right" title="Tutorials" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, bow.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>